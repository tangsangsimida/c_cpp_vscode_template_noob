#include <stdio.h>

/**
 * 知识点：多文件编程与项目组织 (Multi-file Project)
 * 1. 为什么：几万行的代码如果塞在一个文件里，查错就像是大海捞针。
 * 2. 分工：
 *    - .h 文件 (头文件)：像是“说明书”。只放声明，不放具体干活的代码。
 *    - .c 文件 (源文件)：像是“施工队”。负责实现具体的函数功能。
 * 3. 头文件卫士：防止说明书被重复阅读（报错：重复定义）。
 * 4. 符号控制：
 *    - extern: “外面的东西”。引用另一个文件里的全局变量。
 *    - static: “内部的东西”。把函数锁在当前文件，防止外部误用。
 */

// ==========================================
// [模拟环节] 假设下面这一段是写在 "math_utils.h" 里的
// ==========================================
#ifndef SIMULATED_MATH_H  // 如果没定义过这个宏
#define SIMULATED_MATH_H  // 那就定义它，并开始阅读内容

// 这里只是声明：告诉主程序，有一个能算加法的工具。
int add_numbers(int a, int b);

#endif // 结束阅读
// ==========================================


// ==========================================
// [模拟环节] 假设下面这一段是写在 "math_utils.c" 里的
// ==========================================

// 施工队开始干活，实现加法逻辑
int add_numbers(int a, int b) {
    return a + b;
}

// 定义一个只能在 math_utils.c 内部使用的“秘密函数”
static void secret_log() {
    printf("[私有] 内部正在进行数学运算...\n");
}
// ==========================================

int main() {
    printf("==== 1. 多文件分工模型 ====\n");
    printf("[形象比喻] \n");
    printf("  - .h 头文件 = 餐厅的【菜单】(只看到菜名和价格)。\n");
    printf("  - .c 源文件 = 餐厅的【后厨】(具体怎么切菜、炒菜)。\n");
    printf("  - main()    = 【顾客】(根据菜单下单)。\n");

    printf("\n==== 2. extern 与变量共享术 ====\n");
    printf("[知识点] 如果你想在 main.c 用 math_utils.c 里的变量，必须声明 extern。\n");
    printf("  - 语法：extern int server_status;\n");
    
    printf("\n==== 3. 实战模拟：调用外部模块 ====\n");
    // 调用我们在上面模拟实现的“外部”函数
    int result = add_numbers(10, 5);
    printf("  - 调用 add_numbers(10, 5) 结果为: %d\n", result);

    printf("\n==== 4. 【致命警告】工程实践避坑 ====\n");
    
    // 坑点 1：头文件定义变量
    printf("[坑点] 严禁在 .h 文件里定义变量 (如 int x = 10;)。\n");
    printf("  - 否则如果有 10 个 .c 引用了它，链接器会报错：x 重复定义了 10 次！\n");
    printf("  - [正确做法] .h 里写 extern int x; 总文件夹的某个 .c 里写 int x = 10;\n");

    // 坑点 2：循环引用
    printf("\n[建议] 始终使用 #ifndef ... #define ... #endif 结构保护头文件。\n");
    printf("  - 现在的编译器也支持更简单的 #pragma once。\n");

    // 尝试调用 static 函数会报错（此处仅说明原理）
    // secret_log(); // 如果解除注释，编译器会因为找不到函数而报错。
    printf("\n[知识点] 由于 secret_log 是 static 的，它只能在它的“老家”干活。main() 看不见它。\n");

    return 0;
}

/*
 * 【工程化建议】
 * 1. 即使是再小的练习，也尝试把功能函数（如数学运算、绘图）拆分到独立的 .h 和 .c 中。
 * 2. 只有需要给别人用的东西才放在 .h 里。
 * 3. 命名要规范，通常 math.c 对应的就是 math.h。
 */
